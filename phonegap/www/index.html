<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="description" content="A simple app to allocate people to projects." />
    <meta name="author" content="Intuitive Company" />
    
    <title>allocate</title>
    <link href="styles/app.css" rel="stylesheet" />
    <link rel="shortcut icon" href="favicon.png" />
  </head>

  <body>
    <!-- Gulp compiled html templates -->
    <!-- ko if: !auth.currentUser() -->
<div id="auth">
	<div>
		<h1>allocate</h1>
		<div class="alert alert-danger alert-dismissable" data-bind="fadeVisible: auth.errorMessage().length > 0, text: auth.errorMessage"></div>
		<form data-bind="submit: auth.signInUp">
			<input name="auth_email" type="text" class="form-control" placeholder="Email" data-bind="fadeVisible: auth.signUpMode">
			<input name="auth_displayName" type="text" class="form-control" placeholder="First and last name" data-bind="fadeVisible: auth.signUpMode">
			<input name="auth_username" type="text" class="form-control" placeholder="Username" autocapitalize="off">
			<input name="auth_password" type="password" class="form-control" placeholder="Password">
			<input name="auth_confirmPassword" type="password" class="form-control" placeholder="Confirm password" data-bind="fadeVisible: auth.signUpMode">
			<button type="submit" class="btn btn-default navbar-btn" data-bind="text: (auth.signUpMode() ? 'Sign up' : 'Sign in')">Sign in</button> or <a data-bind="event: { touchend: auth.showSignUp }, text: (auth.signUpMode() ? 'sign in' : 'sign up')">Sign up</a>
		</form>
	</div>
</div>
<!-- /ko -->
<!-- ko if: auth.currentUser -->
<div id="header" class="navbar navbar-default" role="navigation">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle fa fa-bars" data-toggle="collapse" data-target=".navbar-collapse"></button>
			<span class="logo" data-bind="event: { touchend: auth.scrollTop }"><img src="svg/logo.svg" /></span>
		</div>
		<div class="navbar-collapse collapse">
			<ul class="nav navbar-nav navbar-right">
				<li class="active"><a href="./">My time</a></li>
				<li><a href="./">People</a></li>
				<li><button class="btn btn-default navbar-btn" data-bind="event: { touchend: auth.logout }">Log out</button></li>
			</ul>
		</div><!--/.nav-collapse -->
	</div><!--/.container-fluid -->
</div>
<!-- /ko -->
<!-- ko if: auth.currentUser -->
<div id="notes" class="screen" data-bind="fadeVisible: steps.currentStep() == 3">
	<h1>Any notes about the projects?</h1>
	<div id="notes-accordion" class="panel-group container" data-bind="foreach: selectProject.allProjects">
		<!-- ko if: $data.active() -->
		<div class="panel panel-default">
			<div class="panel-heading">
				<h4 class="panel-title">
					<a data-toggle="collapse" data-parent="#notes-accordion" data-bind="attr: { href: '#notes-collapse-' + $index() }, text: name"></a>
				</h4>
			</div>
			<div class="panel-collapse collapse" data-bind="attr: { id: 'notes-collapse-' + $index() }">
				<div class="panel-body" onClick="this.contentEditable='true';">
				</div>
			</div>
		</div>
		<!-- /ko -->
	</div>
</div>
<!-- /ko -->
<!-- ko if: auth.currentUser -->
<div id="rate-project" class="screen" data-bind="fadeVisible: steps.currentStep() == 2">
	<div class="project-number"><span data-bind="text: rateProject.activeDomIndex() + 1"></span> of <span data-bind="text: rateProject.projectDomLength"></span></div>
	<ol data-bind="foreach: selectProject.allProjects" class="user-projects">
		<!-- ko if: $data.active() -->
		<li data-bind="tap: function() { $parent.rateProject.goToProject($index(), this, event) }, css: { active: ($parent.rateProject.activeProject() == $index() && $parent.rateProject.activeIndex() == -1) || ($parent.rateProject.activeIndex() == $index()), 'internal': $data.type == 'internal' }, text: $data.name"></li>
		<!-- /ko -->
	</ol>
	<div class="project-fader"></div>
	<div data-bind="text: rateProject.workingPercentage() + '%'" class="working"></div>
	<div class="dial">
		<div class="handle" data-bind="event: { touchstart: rateProject.dragHandle, mousedown: rateProject.dragHandle }"></div>
		<div class="track background">
			<div class="ring"></div>
		</div>
		<div class="track foreground">
			<div class="ring"></div>
		</div>
	</div>
	<div class="row chart" data-bind="foreach: rateProject.columns">
		<!-- ko if: $parent.rateProject.activeProject -->
		<div class="col-xs-4 bar" data-bind="style: { height: ($parent.rateProject.activeProject().percentage()[$index()].value() * 2) + 75 + 'px' }, tap: function() { $parent.rateProject.setColumn($index()) }, css: { active: $parent.rateProject.workingColumn() == $index(), zero: $parent.rateProject.activeProject().percentage()[$index()].value() == 0 }">
			<div class="total" data-bind="style: { height: ($data.total() * 2) + 75 + 'px' }, text: total() + '%', css: { over: $data.total() > 100 }"></div>
			<div class="value" data-bind="text: $parent.rateProject.activeProject().percentage()[$index()].value() + $parent.rateProject.dialSettings().value"></div>
			<div class="date">Week of <span data-bind="text: date"></span></div>
		</div>
		<!-- /ko -->
	</div>
</div>
<!-- /ko -->
<!-- ko if: auth.currentUser -->
<div id="rate-week" class="screen" data-bind="fadeVisible: steps.currentStep() == 1">
	<div class="page-header">
		<h1>Week of</h1>
		<div class="btn-group" data-bind="foreach: rateWeek.weeks">
			<button type="button" class="btn btn-default" data-bind="tap: function() { $parent.rateWeek.selectWeek($index()) }, css: { active: $parent.rateWeek.activeWeek() == $index() }">
				<span data-bind="text: date"></span>
				<div class="total" data-bind="text: total() + '%', css: { over: $data.total() > 100 }"></div>
			</button>
		</div>
	</div>
	<ol data-bind="foreach: selectProject.allProjects, swipe: rateWeek.scroll" class="projects">
		<!-- ko if: $data.active() -->
		<li class="project" data-bind="css: { 'internal': $data.type == 'internal', zero: $data.percentage()[$parent.rateWeek.activeWeek()].value() == 0 }, drag: $parent.rateWeek.drag">
			<div class="name">
				<span class="percent" data-bind="text: percentage()[$parent.rateWeek.activeWeek()].value() + '%'"></span>
				<span data-bind="text: name"></span>
			</div>
			<div class="percentage-container">
				<div class="percentage" data-bind="style: { width: $data.percentage()[$parent.rateWeek.activeWeek()].value() + '%' }"></div>
			</div>
		</li>
		<!-- /ko -->
	</ol>
</div>
<!-- /ko -->
<!-- ko if: auth.currentUser -->
<div id="select-project" class="screen" data-bind="fadeVisible: steps.currentStep() == 0">
	<div class="row">
		<div class="col-xs-6">
			<ul data-bind="foreach: selectProject.allProjects" class="user-projects">
				<!-- ko if: $data.active() -->
				<li data-bind="text: name, tap: $parent.selectProject.toggleProject, css: { 'internal': $data.type == 'internal' }"></li>
				<!-- /ko -->
			</ul>
		</div>
		<div class="col-xs-6">
			<ul data-bind="foreach: selectProject.allProjects" class="all-projects">
				<li data-bind="text: name, tap: $parent.selectProject.toggleProject, css: { active: $data.active(), 'internal': $data.type == 'internal' }"></li>
			</ul>
		</div>
	</div>
</div>
<!-- /ko -->
<!-- ko if: auth.currentUser -->
<div id="steps">
	<button data-bind="fadeVisible: steps.currentStep() > 0, tap: function() { steps.nextStep(-1) }" class="fa fa-chevron-left left"></button>
	<ul data-bind="foreach: steps.steps">
		<li data-bind="css: { active: $data.stepNumber == $parent.steps.currentStep() }"></li>
	</ul>
	<button data-bind="fadeVisible: steps.currentStep() < steps.steps().length - 1, tap: function() { steps.nextStep(1) }" class="fa fa-chevron-right right"></button>
</div>
<!-- /ko -->

    <!--
    Scripts
    ================================================== 
    Placed at the end of the document so the pages load faster -->
    <!-- <script src="scripts/app.js"></script> -->
    <script src="phonegap.js"></script>
    <script src="scripts/vendor.js"></script>
    <script src="scripts/main.js"></script>
  </body>
</html>
